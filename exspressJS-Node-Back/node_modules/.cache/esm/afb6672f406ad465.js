let con;_406‍.x([["getContact",()=>getContact],["getContacts",()=>getContacts],["addContact",()=>addContact],["removeContact",()=>removeContact]]);_406‍.w("../sqlConnect",[["con",["con"],function(v){con=v}]]);

       function getContact(req, res) {
    con.query("SELECT * FROM `contacts` WHERE `id` = ?", [req.params.id], (err, result) => {
        if (err) {
            _406‍.g.console.log(err);
        }

        if(result.length){
            res.send(result[0]);
        }
        else{
            res.send();
        }
        
    });
}

       function getContacts(req,res){
    let isDeleted = 0;

    if (req.query.deleted) {
        isDeleted = 1;
    }
    
    con.query("SELECT * FROM `contacts` WHERE isDeleted = ?", [isDeleted], (err, result) => {
        if (err) {
            _406‍.g.console.log(err);
        }
         res.send(result);
        })
    }

           function addContact(req,res){
    
        con.query("INSERT INTO `contacts` (`firstName`, `lastName`,`birthday`, `email`, `phone`, `state`, `city`, `street`, `postalCode`) VALUES  (?, ?, ?, ?, ?, ?, ?, ?, ?)", [req.body.firstName, req.body.lastName, req.body.birthday, req.body.email, req.body.phone, req.body.state, req.body.city, req.body.street, req.body.postalCode], (err, result) => {
            
                if (err) {
                    _406‍.g.console.log(err);
                }
                
             con.query("SELECT * FROM `contacts` WHERE `id` = ?", [result.insertId], (err, result) => {
            
                if (err) {
                    _406‍.g.console.log(err);
                }
                 res.send(result[0]);
            });
        });
    }


    
//     export function updateContact(req, res) {
//     con.query("UPDATE `contacts` SET `firstName`='?',`lastName`='?',`birthday`='?',`email`='?',`phone`='?',`state`='?',`city`='?',`street`='?',`postalCode`='?' WHERE `id` = ?", [req.body.firstName, req.body.lastName, req.body.birthday, req.body.email, req.body.phone, req.body.state, req.body.city, req.body.street, req.body.postalCode, req.params.id], (err, result) => {
//         if (err) {
//             console.log(err);
//         }
//         res.send();
//     });
con.query("UPDATE `contacts` SET `firstName`=?, `lastName`=?, `birthday`=?, `email`=?, `phone`=?, `state`=?, `city`=?, `street`=?, `postalCode`=? WHERE `id`=?", [req.body.firstName, req.body.lastName, req.body.birthday, req.body.email, req.body.phone, req.body.state, req.body.city, req.body.street, req.body.postalCode, req.params.id], (err, result) => {
    if (err) {
      _406‍.g.console.log(err);
    }
    res.send();
  });
  
// }

  
           function removeContact(req,res){

        con.query("UPDATE `contacts` SET `isDeleted` = 1 WHERE `id` = ?", [req.params.id], (err, result) => {
            
                if (err) {
                    _406‍.g.console.log(err);
                }
                 res.send(result);
            })
        }